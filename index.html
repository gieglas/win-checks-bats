<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Win-checks-bats by gieglas</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Win-checks-bats</h1>
        <p>Batch files to do basic IT checks such as ping test, check log files etc</p>

        <p class="view"><a href="https://github.com/gieglas/win-checks-bats">View the Project on GitHub <small>gieglas/win-checks-bats</small></a></p>


        <ul>
          <li><a href="https://github.com/gieglas/win-checks-bats/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/gieglas/win-checks-bats/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/gieglas/win-checks-bats">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a name="windows-checks-bats" class="anchor" href="#windows-checks-bats"><span class="octicon octicon-link"></span></a>windows-checks-bats</h1>

<p>Batch files to do basic IT checks such as ping test, check log files etc.</p>

<p>These scripts output a JSON Array but can easily be changed to output anything else. </p>

<h2>
<a name="why" class="anchor" href="#why"><span class="octicon octicon-link"></span></a>Why?</h2>

<p>Needed to automate basic IT checks in an environment with different technologies and setups. Tried to make the scripts as flexible as possible. They are not complete and surely not perfect, but could be useful to someone so here they are.</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<pre><code>Just download the files in a folder on your windows PC
</code></pre>

<h2>
<a name="output" class="anchor" href="#output"><span class="octicon octicon-link"></span></a>Output</h2>

<p>Prints on the screen a <strong>notation</strong> and on the next line the <strong>JSON Array</strong> with the results. The notation is printed to help applications recognize when the JSON Array begins. 
For example:</p>

<div class="highlight highlight-json"><pre><span class="err">&lt;notation&gt;</span><span class="p">[</span> <span class="p">{</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"10.10.10.10"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"YES"</span><span class="p">}</span> 
<span class="p">,</span> <span class="p">{</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"10.10.10.11"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"YES"</span><span class="p">}</span> 
<span class="p">,</span> <span class="p">{</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"10.10.10.12"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"NO"</span><span class="p">}</span> 
<span class="p">,</span> <span class="p">{</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"10.10.10.13"</span><span class="p">,</span><span class="nt">"value"</span><span class="p">:</span><span class="s2">"YES"</span><span class="p">}</span> <span class="p">]</span>
</pre></div>

<h2>
<a name="scripts" class="anchor" href="#scripts"><span class="octicon octicon-link"></span></a>Scripts</h2>

<ul>
<li><a href="#pingtestbat">pingTest.bat</a></li>
<li><a href="#checkntbackupbat">checkNTBackup.bat</a></li>
<li><a href="#checknetworkdiskspacebat">checkNetworkDiskSpace.bat</a></li>
<li><a href="#checklogfileexistsbat">checkLogFileExists.bat</a></li>
<li><a href="#checklogfilecontentsbat">checkLogFileContents.bat</a></li>
</ul><h3>
<a name="pingtestbat" class="anchor" href="#pingtestbat"><span class="octicon octicon-link"></span></a>pingTest.bat</h3>

<p>Performs ping on the IPs given and returns a JSON array </p>

<p><strong>Usage</strong></p>

<pre><code>pingTest.bat target1 target2
</code></pre>

<p><strong>Output</strong></p>

<div class="highlight highlight-json"><pre><span class="err">&lt;notation&gt;</span><span class="p">[{</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"DISPLAYNAME"</span><span class="p">,</span> <span class="nt">"value"</span><span class="p">:</span><span class="s2">"YES/NO"</span><span class="p">},</span><span class="err">...</span><span class="p">]</span>
</pre></div>

<h3>
<a name="checkntbackupbat" class="anchor" href="#checkntbackupbat"><span class="octicon octicon-link"></span></a>checkNTBackup.bat</h3>

<p>Checks ntbackup logs. Finds the latest log file in the folder and looks for date (as defined by date format), counts the number of Backup Complete and Backup Verified, as defined in config file. Also checks if the word error exists.All phrases that are searched are defined in the config file as they can be different depending on the localization. 
Idea was taken from <a href="http://www.heinzi.at/projects/ntbackup-logcheck/">ntbackup-logcheck</a></p>

<p><strong>Dependencies</strong></p>

<pre><code>- getDateMinusArg.vbs (to get the CORRECT date)
- getDateFormatVars.bat (to get the Date Variables)
</code></pre>

<p><strong>Usage</strong></p>

<pre><code>checkNTBackup.bat configfile.config
</code></pre>

<p><strong>Config Input</strong></p>

<pre><code>- cscript,C:\Windows\System32\cscript
- getdate,getDateMinusArg.vbs (get date vbscript)
- net,C:\Windows\System32\net.exe
- logfilein,"PATHOFSHAREDFOLDER"#"USERNAME"#"PASSWORD"#"DATEFORMAT"#NOOFCOMPLETED"#"NOOFVERIFIED"#"DISPLAYNAME" 
e.g. _logfilein,"\\BackupServer"#"BackupServer\administrator"#"password"#"#d#/#m#/#yyyy#"#"3"#"0"#"Backups from server."
- backupComplete,Backup completed (localization)
- verifyCompleted,Verify completed (localization)
- errorStr,Error (localization)
- find,C:\Windows\System32\find.exe
- notation,^&lt;notation^&gt; (after this notation is the JSON array)
</code></pre>

<p><strong>Output</strong></p>

<div class="highlight highlight-json"><pre><span class="err">&lt;notation&gt;</span><span class="p">[{</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"DISPLAYNAME"</span><span class="p">,</span> <span class="nt">"value"</span><span class="p">:</span><span class="s2">"ERRORS/OK"</span><span class="p">},</span><span class="err">...</span><span class="p">]</span>
</pre></div>

<h3>
<a name="checknetworkdiskspacebat" class="anchor" href="#checknetworkdiskspacebat"><span class="octicon octicon-link"></span></a>checkNetworkDiskSpace.bat</h3>

<p>Checks the free space in bytes using shared folders. </p>

<p><strong>Dependencies</strong></p>

<pre><code>- getDateMinusArg.vbs (to get the CORRECT date)
</code></pre>

<p><strong>Usage</strong></p>

<pre><code>checkNetworkDiskSpace.bat configfile.config
</code></pre>

<p><strong>Config Input</strong></p>

<pre><code>- cscript,C:\Windows\System32\cscript
- net,C:\Windows\System32\net.exe
- getdate,..\scripts\getDateMinusArg.vbs (get date vbscript)
- checkdisksizepaths,PATHOFSHAREDFOLDER:USERNAME:PASSWORD:TEMPDRIVE#DISPLAYNAME eg\\10.10.10.10\temp:10.10.10.10\administrator:pass:o#10.10.10.10
- notation,^&lt;notation^&gt; (after this notation is the JSON array)
</code></pre>

<p><strong>Output</strong></p>

<div class="highlight highlight-json"><pre><span class="err">&lt;notation&gt;</span><span class="p">[{</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"DISPLAYNAME"</span><span class="p">,</span> <span class="nt">"value"</span><span class="p">:</span><span class="s2">"SIZEinBytes"</span><span class="p">},</span><span class="err">...</span><span class="p">]</span>
</pre></div>

<h3>
<a name="checklogfileexistsbat" class="anchor" href="#checklogfileexistsbat"><span class="octicon octicon-link"></span></a>checkLogFileExists.bat</h3>

<p>Checks if log files with specific format (including date) exists and returns JSON Array</p>

<p><strong>Dependencies</strong></p>

<pre><code>-   getDateMinusArg.vbs (to get the CORRECT date)
-   getDateFormatVars.bat (to get the Date Variables)
</code></pre>

<p><strong>Usage</strong></p>

<pre><code>checkLogFileExists.bat configfile.config
</code></pre>

<p><strong>Config Input</strong></p>

<pre><code>-  cscript,C:\Windows\System32\cscript
-  servicesfolder,log files folder must be shared folder eg \\10.10.10.10\Services
-  net,C:\Windows\System32\net.exe
-  getdate,getDateMinusArg.vbs (get date vbscript)
-  login,log files server login eg administrator pass
-  errorfilesin,PATHOFFILE#"DISPLAYNAME" e.g. \ServiceSubfolder\logs\#yyyy#-#mm#-#dd#\error.log:"Something Generator Service on #yyyy#-#mm#-#dd#" 
-               NOTE: PATHOFFILE can also have #STAR#
-  notation,^&lt;notation^&gt; (after this notation is the JSON array)
</code></pre>

<p><strong>Output</strong></p>

<div class="highlight highlight-json"><pre><span class="err">&lt;notation&gt;</span><span class="p">[{</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"DISPLAYNAME"</span><span class="p">,</span> <span class="nt">"value"</span><span class="p">:</span><span class="s2">"ERRORS/OK"</span><span class="p">},</span><span class="err">...</span><span class="p">]</span>
</pre></div>

<h3>
<a name="checklogfilecontentsbat" class="anchor" href="#checklogfilecontentsbat"><span class="octicon octicon-link"></span></a>checkLogFileContents.bat</h3>

<p>Checks the contents for a keyword including date, and the existence or non existence of phrases. Can search for specific log file or the most recently modified file in the location specified.</p>

<p><strong>Dependencies</strong></p>

<pre><code>-   getDateMinusArg.vbs (to get the CORRECT date)
-   getDateFormatVars.bat (to get the Date Variables)
</code></pre>

<p><strong>Usage</strong></p>

<pre><code>checkLogFileContents.bat configfile.config
</code></pre>

<p><strong>Config Input</strong></p>

<pre><code>-  cscript,C:\Windows\System32\cscript
-  getdate,getDateMinusArg.vbs (get date vbscript)
-  net,C:\Windows\System32\net.exe
-  errorfilesin,"PATHOFSHAREDFOLDER"#"USERNAME"#"PASSWORD"#"SUBFOLDERFILE"#"SEARCHNAME1"#"SEARCHNAME2"#"SEARCHNAMENOT1"#"DISPLAYNAME"#"FILEORLOCATION" 
-               eg"C:\SyncBack_NI\"#""#""#"Server_DB_Backup_Log.txt"#"#dd#/#mm#/#yyyy#"#""#"error"#"Server DB Backup Copied"#"f"
-               eg"\\10.10.10.10\backup"#"10.10.10.10\administrator"#"pass"#"\"#"#_m#/#_d#/#yyyy#"#"Backup completed"#"error"#"10.10.10.10 Daily Backup on #dd#/#mm#/#yyyy#"#"l" 
-               NOTE:SEARCHNAME1,SEARCHNAME2 are the phrases to check if they exist. If they don't exist an error is produced.
-               NOTE:SEARCHNAMENOT1 is the phrase to check if it does NOT exist. If it exists an error is produced.
-               NOTE:FILEORLOCATION "l" finds the last file in the folder "f" finds the spesific file
-  find,C:\Windows\System32\find.exe
-  notation,^&lt;notation^&gt; (after this notation is the JSON array
</code></pre>

<p><strong>Output</strong></p>

<div class="highlight highlight-json"><pre><span class="err">&lt;notation&gt;</span><span class="p">[{</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"DISPLAYNAME"</span><span class="p">,</span> <span class="nt">"value"</span><span class="p">:</span><span class="s2">"ERRORS/OK"</span><span class="p">},</span><span class="err">...</span><span class="p">]</span>
</pre></div>

<h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p>The MIT License (MIT)</p>

<p>Copyright (c) 2013 gieglas</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/gieglas">gieglas</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>