{"name":"Win-checks-bats","tagline":"Batch files to do basic IT checks such as ping test, check log files etc","body":"windows-checks-bats\r\n===================\r\n\r\nBatch files to do basic IT checks such as ping test, check log files etc.\r\n\r\nThese scripts output a JSON Array but can easily be changed to output anything else. \r\n\r\nWhy?\r\n----\r\n\r\nNeeded to automate basic IT checks in an environment with different technologies and setups. Tried to make the scripts as flexible as possible. They are not complete and surely not perfect, but could be useful to someone so here they are.\r\n\r\nInstallation\r\n------------\r\n\r\n\tJust download the files in a folder on your windows PC\r\n\r\nOutput\r\n------\r\nPrints on the screen a **notation** and on the next line the **JSON Array** with the results. The notation is printed to help applications recognize when the JSON Array begins. \r\nFor example:\r\n ```json\r\n<notation>[ {\"name\":\"10.10.10.10\",\"value\":\"YES\"} \r\n, {\"name\":\"10.10.10.11\",\"value\":\"YES\"} \r\n, {\"name\":\"10.10.10.12\",\"value\":\"NO\"} \r\n, {\"name\":\"10.10.10.13\",\"value\":\"YES\"} ]\r\n```\r\n\r\nScripts\r\n-------\r\n\r\n- [pingTest.bat]\r\n- [checkNTBackup.bat]\r\n- [checkNetworkDiskSpace.bat]\r\n- [checkLogFileExists.bat]\r\n- [checkLogFileContents.bat]\r\n\r\n### pingTest.bat\r\n\r\nPerforms ping on the IPs given and returns a JSON array \r\n\r\n**Usage**\r\n\r\n\tpingTest.bat target1 target2\r\n\r\n**Output**\r\n\r\n```json\r\n<notation>[{\"name\":\"DISPLAYNAME\", \"value\":\"YES/NO\"},...]\r\n```\r\n\r\n### checkNTBackup.bat\r\n\r\nChecks ntbackup logs. Finds the latest log file in the folder and looks for date (as defined by date format), counts the number of Backup Complete and Backup Verified, as defined in config file. Also checks if the word error exists.All phrases that are searched are defined in the config file as they can be different depending on the localization. \r\nIdea was taken from [ntbackup-logcheck]\r\n\r\n**Dependencies**\r\n\r\n    - getDateMinusArg.vbs (to get the CORRECT date)\r\n    - getDateFormatVars.bat (to get the Date Variables)\r\n\r\n**Usage**\r\n\r\n    checkNTBackup.bat configfile.config\r\n\r\n**Config Input**\r\n\r\n    - cscript,C:\\Windows\\System32\\cscript\r\n    - getdate,getDateMinusArg.vbs (get date vbscript)\r\n    - net,C:\\Windows\\System32\\net.exe\r\n    - logfilein,\"PATHOFSHAREDFOLDER\"#\"USERNAME\"#\"PASSWORD\"#\"DATEFORMAT\"#NOOFCOMPLETED\"#\"NOOFVERIFIED\"#\"DISPLAYNAME\" \r\n    e.g. _logfilein,\"\\\\BackupServer\"#\"BackupServer\\administrator\"#\"password\"#\"#d#/#m#/#yyyy#\"#\"3\"#\"0\"#\"Backups from server.\"\r\n    - backupComplete,Backup completed (localization)\r\n    - verifyCompleted,Verify completed (localization)\r\n    - errorStr,Error (localization)\r\n    - find,C:\\Windows\\System32\\find.exe\r\n    - notation,^<notation^> (after this notation is the JSON array)\r\n\r\n**Output**\r\n\r\n```json\r\n<notation>[{\"name\":\"DISPLAYNAME\", \"value\":\"ERRORS/OK\"},...]\r\n```\r\n\r\n### checkNetworkDiskSpace.bat\r\n\r\nChecks the free space in bytes using shared folders. \r\n\r\n**Dependencies**\r\n\r\n    - getDateMinusArg.vbs (to get the CORRECT date)\r\n\r\n**Usage**\r\n\r\n    checkNetworkDiskSpace.bat configfile.config\r\n\r\n**Config Input**\r\n\r\n\t- cscript,C:\\Windows\\System32\\cscript\r\n\t- net,C:\\Windows\\System32\\net.exe\r\n\t- getdate,..\\scripts\\getDateMinusArg.vbs (get date vbscript)\r\n\t- checkdisksizepaths,PATHOFSHAREDFOLDER:USERNAME:PASSWORD:TEMPDRIVE#DISPLAYNAME eg\\\\10.10.10.10\\temp:10.10.10.10\\administrator:pass:o#10.10.10.10\r\n\t- notation,^<notation^> (after this notation is the JSON array)\r\n\t\r\n**Output**\r\n\r\n```json\r\n<notation>[{\"name\":\"DISPLAYNAME\", \"value\":\"SIZEinBytes\"},...]\r\n```\r\n\r\n### checkLogFileExists.bat\r\n\r\nChecks if log files with specific format (including date) exists and returns JSON Array\r\n\r\n**Dependencies**\r\n\r\n\t-\tgetDateMinusArg.vbs (to get the CORRECT date)\r\n\t-\tgetDateFormatVars.bat (to get the Date Variables)\r\n\r\n**Usage**\r\n\r\n    checkLogFileExists.bat configfile.config\r\n\r\n**Config Input**\r\n\r\n\t-  cscript,C:\\Windows\\System32\\cscript\r\n\t-  servicesfolder,log files folder must be shared folder eg \\\\10.10.10.10\\Services\r\n\t-  net,C:\\Windows\\System32\\net.exe\r\n\t-  getdate,getDateMinusArg.vbs (get date vbscript)\r\n\t-  login,log files server login eg administrator pass\r\n\t-  errorfilesin,PATHOFFILE#\"DISPLAYNAME\" e.g. \\ServiceSubfolder\\logs\\#yyyy#-#mm#-#dd#\\error.log:\"Something Generator Service on #yyyy#-#mm#-#dd#\" \r\n\t- \t\t\t\tNOTE: PATHOFFILE can also have #STAR#\r\n\t-  notation,^<notation^> (after this notation is the JSON array)\r\n\t\r\n**Output**\r\n\r\n```json\r\n<notation>[{\"name\":\"DISPLAYNAME\", \"value\":\"ERRORS/OK\"},...]\r\n```\r\n\r\n### checkLogFileContents.bat\r\n\r\nChecks the contents for a keyword including date, and the existence or non existence of phrases. Can search for specific log file or the most recently modified file in the location specified.\r\n\r\n**Dependencies**\r\n\r\n\t-\tgetDateMinusArg.vbs (to get the CORRECT date)\r\n\t-\tgetDateFormatVars.bat (to get the Date Variables)\r\n\r\n**Usage**\r\n\r\n    checkLogFileContents.bat configfile.config\r\n\r\n**Config Input**\r\n\r\n\t-  cscript,C:\\Windows\\System32\\cscript\r\n\t-  getdate,getDateMinusArg.vbs (get date vbscript)\r\n\t-  net,C:\\Windows\\System32\\net.exe\r\n\t-  errorfilesin,\"PATHOFSHAREDFOLDER\"#\"USERNAME\"#\"PASSWORD\"#\"SUBFOLDERFILE\"#\"SEARCHNAME1\"#\"SEARCHNAME2\"#\"SEARCHNAMENOT1\"#\"DISPLAYNAME\"#\"FILEORLOCATION\" \r\n\t-\t\t\t\teg\"C:\\SyncBack_NI\\\"#\"\"#\"\"#\"Server_DB_Backup_Log.txt\"#\"#dd#/#mm#/#yyyy#\"#\"\"#\"error\"#\"Server DB Backup Copied\"#\"f\"\r\n\t-\t\t\t\teg\"\\\\10.10.10.10\\backup\"#\"10.10.10.10\\administrator\"#\"pass\"#\"\\\"#\"#_m#/#_d#/#yyyy#\"#\"Backup completed\"#\"error\"#\"10.10.10.10 Daily Backup on #dd#/#mm#/#yyyy#\"#\"l\" \r\n\t-\t\t\t\tNOTE:SEARCHNAME1,SEARCHNAME2 are the phrases to check if they exist. If they don't exist an error is produced.\r\n\t-\t\t\t\tNOTE:SEARCHNAMENOT1 is the phrase to check if it does NOT exist. If it exists an error is produced.\r\n\t-\t\t\t\tNOTE:FILEORLOCATION \"l\" finds the last file in the folder \"f\" finds the spesific file\r\n\t-  find,C:\\Windows\\System32\\find.exe\r\n\t-  notation,^<notation^> (after this notation is the JSON array\r\n\t\r\n**Output**\r\n\r\n```json\r\n<notation>[{\"name\":\"DISPLAYNAME\", \"value\":\"ERRORS/OK\"},...]\r\n```\r\n\r\nLicense\r\n-------\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2013 gieglas\r\n[ntbackup-logcheck]: http://www.heinzi.at/projects/ntbackup-logcheck/\r\n[pingTest.bat]:#pingtestbat\r\n[checkNTBackup.bat]:#checkntbackupbat\r\n[checkNetworkDiskSpace.bat]:#checknetworkdiskspacebat\r\n[checkLogFileExists.bat]:#checklogfileexistsbat\r\n[checkLogFileContents.bat]:#checklogfilecontentsbat","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}